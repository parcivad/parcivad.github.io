<!DOCTYPE html>
<html lang="de" class="h-100">
<head>
    <!--Required Meta -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <!--Social Media Headline-->
    <meta property="og:local" content="de_DE">
    <meta property="og:title" content="Classync"/>
    <meta property="og:description" content="TODO: Beschreibung" />
    <meta property="og:url" content="https://www.classync.de/go">
    <meta property="og:type" content="Website"/>

    <link rel="preconnect" href="https://unpkg.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">

    <!--Standard Meta-->
    <title>Classync</title>

    <!--Favicon Icons-->
    <link href="/go/img/favicon/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
    <link href="/go/img/favicon/favicon-32x32.png" rel="icon" type="image/png" sizes="32x32">
    <link href="/go/img/favicon/favicon-16x16.png" rel="icon" type="image/png" sizes="16x16">
    <link href="/go/img/favicon/site.webmanifest" rel="manifest">

    <!--Bootstrap and Vendor-->
    <link href="/vendor/bootstrap/bootstrap.css" rel="stylesheet" type="text/css">
    <script src="/vendor/bootstrap/bootstrap.js"></script>
    <script src="/vendor/popper/popper.min.js" type="text/javascript"></script>

    <!--CSS-->
    <link href="/go/css/classync.css" rel="stylesheet" type="text/css">
    <link href="/go/css/blob.css" rel="stylesheet" type="text/css">

    <!--Site theme Meta-->
    <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
    <meta name="theme-color" content="#000000" media="(prefers-color-scheme: dark)">

    <!--Icon animation styling-->
    <style>
        #classyncIconLayer0 {fill: #000}
        @media (prefers-color-scheme: dark) {#classyncIconLayer0 {fill: #fff;}}
        #classyncIconLayer1 {animation: iconLayer1 running infinite 2s 0ms}
        @keyframes iconLayer1 { 0% {transform: none} 50% {transform: translateX(80px) translateY(-80px)} 82% {transform: none} }
        #classyncIconLayer2 {animation: iconLayer2 running infinite 2s 150ms}
        @keyframes iconLayer2 { 0% {transform: none} 45% {transform: translateX(160px) translateY(-160px)} 90% {transform: none} }
        #classyncIconLayer3 {animation: iconLayer3 running infinite 2s 300ms}
        @keyframes iconLayer3 { 0% {transform: none} 40% {transform: translateX(240px) translateY(-240px)} 98% {transform: none} }
    </style>
</head>

<body class="h-100">

<div class="w-100 h-100" id="root">
    <div class="w-100 h-50 d-flex align-items-end justify-content-center" style="background-color: var(--bg-sidebar)">
        <div>
            <svg width="90" height="100%" viewBox="0 0 2053 2212" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xml:space="preserve"
                 style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
                <g>
                    <path id="classyncIconLayer3"
                          d="M942.097,2211.69c170.812,0 320.821,-32.696 450.025,-98.087c129.205,-65.392 231.473,-155.581 306.806,-270.565c75.333,-114.984 116.503,-247.085 123.511,-396.301l1.313,-27.649l-533.46,-0l-2.628,19.749c-7.884,62.32 -26.936,117.398 -57.157,165.235c-30.22,47.837 -69.639,85.142 -118.254,111.913c-48.616,26.771 -104.897,40.156 -168.842,40.156c-77.961,0 -144.972,-21.943 -201.033,-65.83c-56.062,-43.887 -99.203,-106.866 -129.424,-188.935c-30.22,-82.069 -45.331,-179.718 -45.331,-292.946l0,-2.634c0,-113.229 15.111,-210.439 45.331,-291.63c30.221,-81.191 73.362,-143.511 129.424,-186.959c56.061,-43.449 122.634,-65.173 199.719,-65.173c63.945,0 120.883,13.825 170.812,41.474c49.93,27.649 90.225,65.611 120.883,113.887c30.659,48.276 48.616,103.135 53.872,164.577l1.314,14.482l533.461,0l-1.314,-30.282c-6.132,-145.705 -47.521,-275.831 -124.168,-390.376c-76.647,-114.546 -179.791,-204.734 -309.434,-270.564c-129.642,-65.831 -278.117,-98.747 -445.426,-98.747c-195.34,0 -363.305,40.157 -503.897,120.471c-140.592,80.313 -248.773,195.298 -324.544,344.953c-75.771,149.655 -113.656,328.056 -113.656,535.204l-0,2.633c-0,207.148 37.885,385.549 113.656,535.204c75.771,149.656 184.171,264.859 325.201,345.612c141.03,80.752 308.776,121.128 503.24,121.128Z"
                          style="fill:#82cfff;fill-rule:nonzero;"/>
                    <path id="classyncIconLayer2"
                          d="M1010.79,2165.81c170.813,0 320.821,-32.696 450.026,-98.088c129.204,-65.391 231.473,-155.58 306.805,-270.564c75.333,-114.984 116.503,-247.085 123.511,-396.301l1.314,-27.649l-533.461,-0l-2.628,19.749c-7.883,62.32 -26.936,117.398 -57.156,165.235c-30.221,47.837 -69.639,85.141 -118.255,111.913c-48.616,26.771 -104.897,40.156 -168.842,40.156c-77.96,0 -144.971,-21.943 -201.033,-65.83c-56.062,-43.888 -99.203,-106.866 -129.423,-188.935c-30.221,-82.069 -45.331,-179.718 -45.331,-292.947l-0,-2.633c-0,-113.229 15.11,-210.439 45.331,-291.63c30.22,-81.191 73.361,-143.511 129.423,-186.959c56.062,-43.449 122.635,-65.173 199.719,-65.173c63.946,0 120.883,13.825 170.813,41.474c49.93,27.648 90.224,65.611 120.883,113.887c30.658,48.276 48.615,103.135 53.871,164.577l1.314,14.482l533.461,0l-1.314,-30.282c-6.132,-145.705 -47.521,-275.831 -124.168,-390.376c-76.646,-114.546 -179.791,-204.734 -309.433,-270.565c-129.642,-65.83 -278.118,-98.746 -445.427,-98.746c-195.339,0 -363.305,40.157 -503.897,120.471c-140.592,80.313 -248.773,195.298 -324.544,344.953c-75.77,149.655 -113.656,328.056 -113.656,535.204l0,2.633c0,207.148 37.886,385.549 113.656,535.204c75.771,149.655 184.171,264.859 325.201,345.612c141.03,80.752 308.777,121.128 503.24,121.128Z"
                          style="fill:#55b5ff;fill-rule:nonzero;"/>
                    <path id="classyncIconLayer1"
                          d="M1079.48,2096.98c170.812,0 320.821,-32.696 450.025,-98.088c129.204,-65.392 231.473,-155.58 306.806,-270.564c75.332,-114.985 116.503,-247.085 123.51,-396.301l1.314,-27.649l-533.46,-0l-2.628,19.749c-7.884,62.32 -26.936,117.398 -57.157,165.235c-30.221,47.837 -69.639,85.141 -118.255,111.913c-48.616,26.771 -104.896,40.156 -168.841,40.156c-77.961,0 -144.972,-21.943 -201.034,-65.83c-56.061,-43.888 -99.202,-106.866 -129.423,-188.935c-30.221,-82.069 -45.331,-179.718 -45.331,-292.947l0,-2.633c0,-113.229 15.11,-210.439 45.331,-291.63c30.221,-81.191 73.362,-143.511 129.423,-186.96c56.062,-43.448 122.635,-65.172 199.72,-65.172c63.945,0 120.882,13.824 170.812,41.473c49.93,27.649 90.224,65.612 120.883,113.888c30.659,48.276 48.616,103.134 53.872,164.577l1.314,14.482l533.46,0l-1.314,-30.282c-6.131,-145.705 -47.521,-275.831 -124.167,-390.376c-76.647,-114.546 -179.791,-204.734 -309.434,-270.565c-129.642,-65.83 -278.118,-98.746 -445.426,-98.746c-195.34,0 -363.305,40.157 -503.897,120.47c-140.592,80.314 -248.773,195.298 -324.544,344.954c-75.771,149.655 -113.656,328.056 -113.656,535.204l-0,2.633c-0,207.147 37.885,385.549 113.656,535.204c75.771,149.655 184.171,264.859 325.201,345.612c141.03,80.752 308.776,121.128 503.24,121.128Z"
                          style="fill:#008dff;fill-rule:nonzero;"/>
                    <path id="classyncIconLayer0"
                          d="M1171.06,2005.21c170.812,-0 320.821,-32.696 450.025,-98.088c129.204,-65.392 231.473,-155.58 306.806,-270.564c75.332,-114.985 116.503,-247.085 123.51,-396.301l1.314,-27.649l-533.461,-0l-2.627,19.749c-7.884,62.32 -26.936,117.398 -57.157,165.235c-30.221,47.837 -69.639,85.141 -118.255,111.912c-48.616,26.772 -104.896,40.157 -168.841,40.157c-77.961,0 -144.972,-21.943 -201.034,-65.831c-56.061,-43.887 -99.202,-106.865 -129.423,-188.934c-30.221,-82.069 -45.331,-179.718 -45.331,-292.947l-0,-2.633c-0,-113.229 15.11,-210.439 45.331,-291.63c30.221,-81.192 73.362,-143.511 129.423,-186.96c56.062,-43.448 122.635,-65.172 199.72,-65.172c63.945,-0 120.882,13.824 170.812,41.473c49.93,27.649 90.224,65.612 120.883,113.887c30.659,48.276 48.616,103.135 53.872,164.577l1.313,14.483l533.461,0l-1.314,-30.282c-6.131,-145.705 -47.521,-275.831 -124.167,-390.376c-76.647,-114.546 -179.791,-204.734 -309.434,-270.565c-129.642,-65.831 -278.118,-98.746 -445.426,-98.746c-195.34,0 -363.306,40.157 -503.897,120.47c-140.592,80.314 -248.774,195.298 -324.544,344.953c-75.771,149.656 -113.656,328.057 -113.656,535.205l-0,2.633c-0,207.147 37.885,385.549 113.656,535.204c75.77,149.655 184.171,264.859 325.201,345.611c141.029,80.753 308.776,121.129 503.24,121.129Z"/>
                    </g>
            </svg>
        </div>
    </div>
    <div class="w-100 h-50 d-flex align-items-end justify-content-center" style="background-color: var(--bg-sidebar)">
        <div class="text-center">
            <p class="m-0" style="font-size: 10pt; color: var(--sys-gray)">© Classync 2023</p>
            <h5 class="fw-bold pb-5">Timur Stegmann</h5>
        </div>
    </div>
</div>

<!-- Libraries and Frameworks -->
<script defer src="/vendor/jquery-3.6.0.min.js"></script>
<script defer crossorigin src="/vendor/react/react.development.js"></script>
<script defer crossorigin src="/vendor/react/react-dom.development.js"></script>
<script defer crossorigin src="/vendor/babel.min.js"></script>
<script defer type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
<script defer nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/framer-motion@10.9.1/dist/framer-motion.dev.min.js"></script>
<script defer src="/vendor/echarts.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/zxcvbn/4.2.0/zxcvbn.js"></script>

<script defer src="/go/js/TextUtils.js" rel="script" type="text/javascript"></script>
<script defer src="/go/js/CookieHandler.js" rel="script" type="text/javascript"></script>
<script defer src="/go/js/DataHolder.js" rel="script" type="text/javascript"></script>
<script defer src="/go/js/Permission.js" rel="script" type="text/javascript"></script>
<script defer src="/go/js/StudentApi.js" rel="script" type="text/javascript"></script>
<script defer src="/go/js/URLParams.js" rel="script" type="text/javascript"></script>
<script defer src="/go/js/Validation.js" rel="script" type="text/javascript"></script>

<!-- React Components -->
<script defer type="text/babel" src="/go/react/Classync.jsx"></script>
<script defer type="text/babel" src="/go/react/ContainerProfile.jsx"></script>
<script defer type="text/babel" src="/go/react/ContainerPoll.jsx"></script>
<script defer type="text/babel" src="/go/react/ContainerRanking.jsx"></script>
<script defer type="text/babel" src="/go/react/ContainerQuotation.jsx"></script>
<script defer type="text/babel" src="/go/react/ContainerStudents.jsx"></script>
<script defer type="text/babel" src="/go/react/ContainerTeachers.jsx"></script>
<script defer type="text/babel" src="/go/react/ContainerFinance.jsx"></script>
<script defer type="text/babel" src="/go/react/ContainerAccount.jsx"></script>
<script defer type="text/babel" src="/go/react/ContainerModeration.jsx"></script>
<script defer type="text/babel" src="/go/react/ContainerLegalWritings.jsx"></script>
<script defer type="text/babel" src="/go/react/ContainerAuditLog.jsx"></script>
<script defer type="text/babel" src="/go/react/ContainerCalendar.jsx"></script>
<script defer type="text/babel" src="/go/react/ContentHolder.jsx"></script>
<script defer type="text/babel" src="/go/react/Container.jsx"></script>
<script defer type="text/babel" src="/go/react/DangerZone.jsx"></script>
<script defer type="text/babel" src="/go/react/Header.jsx"></script>
<script defer type="text/babel" src="/go/react/ActionBar.jsx"></script>
<script defer type="text/babel" src="/go/react/Popup.jsx"></script>
<script defer type="text/babel" src="/go/react/Sidebar.jsx"></script>
<script defer type="text/babel" src="/go/react/Items.jsx"></script>
<script type="text/babel">
    /**
     * with given ID searches for matching go and teach ID
     */
    function getPerson(id) {
        let student = getDH("students").find(s => s.studentId === id)
        if (student !== undefined) return student;
        return getDH("teachers").find(t => t.teacherId === id)
    }


    /**
     * check for permission in students identity
     * @param permissionName    Permission to look for
     * @returns {*|boolean}     Has permission
     */
    function hasPermission(permissionName) {return getDH("identity").permissions[permissionName]}

    /**
     * irritates through identity role to find the highest power level and compares with given parameter
     * @param powerLevel    PowerLevel to compare
     * @returns {boolean}   Is higher
     */
    function hasPowerLevel(powerLevel) {
        let highestPowerLevel = 0;
        getDH("identity").roles.forEach(roleId => {
            let powerLvl = getDH("roles").find(role => role.roleId === roleId).powerLvl;
            if (powerLvl > highestPowerLevel) highestPowerLevel = powerLvl;
        })

        return highestPowerLevel > powerLevel;
    }

    /**
     * made for validation of input text
     * @param val           Value to validate
     * @param min           min length
     * @param max           max length
     * @returns {JSX.Element|null}
     */
    function validateText(val, min, max) {
        if (val.length < min) {
            return <p className="m-0" style={{zIndex: 9, paddingTop: "-10px", color: "var(--sys-red)", fontSize: "10pt"}}>
                +{min-val.length} Zeichen
            </p>
        }

        if (val.length > max) {
            return <p className="m-0" style={{color: "var(--sys-red)", fontSize: "10pt"}}>
                -{val.length-max} Zeichen
            </p>
        }

        return null;
    }

    /**
     * made for validation of any input
     * @param val           Value to validate
     * @returns {JSX.Element}
     */
    function validateNotBlank(val) {
        if (!val) return <p className="m-0" style={{zIndex: 9, paddingTop: "-10px", color: "var(--sys-red)", fontSize: "10pt"}}>
            Bitte ausfüllen
        </p>;

        return null;
    }

    /**
     * made for validation of any input
     * @param val           Value to validate
     * @param minVal        Minimum of value
     * @returns {JSX.Element}
     */
    function validateMin(val, minVal) {
        if (val <= minVal) return <p className="m-0" style={{zIndex: 9, paddingTop: "-10px", color: "var(--sys-red)", fontSize: "10pt"}}>
            Muss mindestens {minVal} betragen
        </p>;

        return null;
    }
</script>
<script defer type="text/babel">
    const root = ReactDOM.createRoot(document.getElementById("root"));

    /**
     * Fetches initial data to perform further actions
     * @returns {Promise<unknown>}
     */
    function bootUp() {
        return new Promise((resolve, reject) => {
            initDH("courses", 3600000, "/student/courses", "GET", null)
                .then(() => initDH("identity", 3600000, "/student/00000000-0000-0000-0000-000000000000/identity", "GET", null)
                    .then(() => initDH("students", 3600000, "/student/students", "GET", null)
                            .then(() => initDH("roles", 1800000, `/student/role`, "GET", null)
                                .then(() => initDH("permissions", 3600000, "/student/permission", "GET", null)
                                    .then(() => initDH("calendar", 1800000, "/student/calendar", "GET", null)
                                        .then(() => initDH("teachers", 3600000, "/student/teacher", "GET", null)
                                            .then(() => initDH("calendarEntries", 3600000, "/student/calendar/entries", "GET", null)
                                                .then(() => initDH("calendarReplacements", 900000, "/student/calendar/replacements", "GET", null)
                                                    .then(() => initDH("finance", 900000, "/student/finance/transactions", "GET", null)
                                                        .then(() => initDH("quotations", 300000, "/student/quotation", "GET", null)
                                                            .then(() => initDH("rankings", 300000, "/student/ranking", "GET", null)
                                                                .then(() => initDH("polls", 300000, "/student/poll", "GET", null)
                                                                    .then(() => initDH("comments", 300000, "/student/comment", "GET", null)
                                                                        .then(() => initDH("questions", 300000, "/student/question", "GET", null)
                                                                            .then(() => hasPermission("auditlog.show") ? initDH("auditLogs", 600000, "/student/auditlog", "GET", null)
                                                                                .then(() => resolve()) : resolve())))))))))))))))
                .catch(error => reject(error))
        })
    }

    function OAuthProcessRequired() {
        eraseCookies();
        root.render(<ClassyncOAuthProcess />)
    }

    // render application after first bootUp or Display error
    bootUp().then(() => root.render(<Classync />))
        .catch(error => {
            if (error["error_key"] === "authentication_required" || error["error_key"] === "token_expired") return
            if (error["error_key"] === "user_not_found") { OAuthProcessRequired(); return }

            // render information loader
            root.render(
                <ContainerInformationBanner
                    color="red" icon="planet-outline" title="Sorry!"
                    description={`Etwas ist schiefgelaufen. Überprüfe deine Internet Verbindung oder versuche es zu einem späteren Zeitpunkt.`} />
            )
        })
</script>
</body>
</html>
